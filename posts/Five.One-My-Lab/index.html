<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Five - My Lab :D" /><meta property="og:locale" content="en" /><meta name="description" content="Intro Hello! Welcome to the introduction of my lab environment! Each and every aspect was enabled and created after months of working on live samples. First off I’ll explain my Malware analysis lab. It is quite straight forward but has minute details." /><meta property="og:description" content="Intro Hello! Welcome to the introduction of my lab environment! Each and every aspect was enabled and created after months of working on live samples. First off I’ll explain my Malware analysis lab. It is quite straight forward but has minute details." /><link rel="canonical" href="https://ra2302.github.io/posts/Five.One-My-Lab/" /><meta property="og:url" content="https://ra2302.github.io/posts/Five.One-My-Lab/" /><meta property="og:site_name" content="Ra-Sec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-09-14T01:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Five - My Lab :D" /><meta name="twitter:site" content="@Ra16848771" /><meta name="google-site-verification" content="ERfD-xPJRqtpaqqpL8aef9xqeMy-42eAa0FCL-tluwg" /> <script type="application/ld+json"> {"headline":"Five - My Lab :D","dateModified":"2025-12-31T13:01:28+05:30","datePublished":"2025-09-14T01:00:00+05:30","description":"Intro Hello! Welcome to the introduction of my lab environment! Each and every aspect was enabled and created after months of working on live samples. First off I’ll explain my Malware analysis lab. It is quite straight forward but has minute details.","mainEntityOfPage":{"@type":"WebPage","@id":"https://ra2302.github.io/posts/Five.One-My-Lab/"},"url":"https://ra2302.github.io/posts/Five.One-My-Lab/","@type":"BlogPosting","@context":"https://schema.org"}</script><title>Five - My Lab :D | Ra-Sec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ra-Sec"><meta name="application-name" content="Ra-Sec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ra-Sec</a></div><div class="site-subtitle font-italic">欢迎来到我的网站!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ra2302" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Ra16848771" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ramneek2302','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Five - My Lab :D</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Five - My Lab :D</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Ra2302 </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Sep 14, 2025, 1:00 AM +0530" >Sep 14, 2025<i class="unloaded">2025-09-14T01:00:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Dec 31, 2025, 1:01 PM +0530" >Dec 31, 2025<i class="unloaded">2025-12-31T13:01:28+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="670 words">3 min read</span></div></div><div class="post-content"><h2 id="intro">Intro</h2><p>Hello! Welcome to the introduction of my lab environment! Each and every aspect was enabled and created after months of working on live samples. First off I’ll explain my Malware analysis lab. It is quite straight forward but has minute details.</p><h5 id="all-the-diagram-and-screenshots-are-my-own">All the diagram and screenshots are my own</h5><h3 id="malware-analysis-lab">Malware Analysis Lab</h3><p><img data-proofer-ignore data-src="/assets/Labs/Malware%20Labu.jpg" alt="Malwere Lab" /></p><p>To begin with, I am using <a href="https://github.com/mandiant/flare-vm">FlareVM by Mandiant</a>. I did a minimal install due to storage concerns and installed tools as per my requirements. I also tried and removed VMware traces from this VM just for extra hardening and to make it more realistic. I have created dummy files, and made it so that it actually feels like a normal desktop. It is completely isolated from the host and it uses Remnx VM as a bastion host/firewall to access host/internet. So that I’d have complete control and monitoring over the network traffic to and from FlareVM.</p><p><a href="https://remnux.org/">RemnuxVM</a>, I am mainly using for it’s intended purposes only, which is, for Linux binary RE. On top of that it acts as a bastion host, firewall, and a killswitch (custom script deployed to enable/disable internet for FlareVM). I also use it for inetsim and wireshark, as I prefer to keep the network tools off of FlareVM especially when doing dynamic analysis.</p><p>My host, is my trusty Ubuntu laptop. It hosts VMware and OpenVPN client. That’s pretty much all there is to it :)</p><p>The VPN server is the smallest possible Azure VM in a region somewhere in Asia(mostly). I have an ARM template to set up OpenVPN in my specified region. I like the VPN to be multi-region just as an added layer of security. Moreover it never takes more than 30 mins to do so. So for every new sample I tend to switch regions (Especially if it was a region specific attack). Though you might think that it is an overkill to have a new server for every sample, but it also allows me to freely scan and enumerate any IP or Host, especially with the help of <a href="https://github.com/smicallef/spiderfoot">SpiderFoot</a>. So when you add that extra step, it starts to make sense. I host my own VPN server just cause it is free :)</p><p>And the last state is the Internet, the world where it all happens!</p><h3 id="adir-lab">AD/IR Lab</h3><p><img data-proofer-ignore data-src="/assets/Labs/AD.drawio.png" alt="AD Lab" /><br /> My second lab environment is a hybrid AD environment, consisting of a Microsoft Developer Subscription which includes entra ID, Defender for Identity and many more things for free :D. To make it an authentic environment, I am hosting another Domain Controller in Azure making it similar to real world environments. I have groups and roles on both Entra and “on-prem”. So a lot of identity action after initial compromise on my Windows VM.<br /> To maintain and collect all the logs(Security Event IDs and Sysmon logs), I have a log analytics workspace, it collects logs from On-prem DC and the user device. And it seems that this is it for the environment.<br /> It really doesn’t sound much but I guess when it comes to AD and Azure, setting it up properly takes time. I still do remember, AMA and DCR troubleshooting to get the desried logs and then trying to parse them in a decent format because I don’t have Security Events table as I am not using Sentinel (PS - Sentinel is expensive D:). And not to mention the roles and policies. If I start to explain those, It would take quite a long time and the article would go on for a while. All of the AD environment is inspired from the environments which I have seen in my Clients (There are like 20 clients. I have good security experience, PS - I am searching for a new job :D).</p><p>I intend to integrate my malware learnings and my forensic skills in this AD environment to boost my skill development.</p><p>You would be seeing a lot more of these environments in the coming environments! If you’d like to see the environments in detail, feel free to reach out!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/days-of-security/'>Days of Security</a>, <a href='/categories/research/'>research</a>, <a href='/categories/malware/'>malware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/security-research/" class="post-tag no-text-decoration" >Security Research</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Five - My Lab :D - Ra-Sec&url=https://ra2302.github.io/posts/Five.One-My-Lab/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Five - My Lab :D - Ra-Sec&u=https://ra2302.github.io/posts/Five.One-My-Lab/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Five - My Lab :D - Ra-Sec&url=https://ra2302.github.io/posts/Five.One-My-Lab/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Eight-Blizzard-Windows-Forensics/">Eight - TryHackMe - Blizzard Windows Forensics Challenge</a><li><a href="/posts/Five.One-My-Lab/">Five - My Lab :D</a><li><a href="/posts/Seven-PureHVNC-Dropper/">Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer</a><li><a href="/posts/Six-Linux-Forensics-IronShade/">Six - TryHackMe - IronShade Linux Forensics Challenge</a><li><a href="/posts/Four-Diskrupt-THM/">Four - TryHackMe - Diskrupt Forensics Challenge</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/privlege-escalation/">privlege-escalation</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/digital-forensics/">Digital Forensics</a> <a class="post-tag" href="/tags/malware-analysis/">Malware Analysis</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/ffuf/">ffuf</a> <a class="post-tag" href="/tags/getcap/">getcap</a> <a class="post-tag" href="/tags/john/">john</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/One-Kioptrix-1/"><div class="card-body"> <span class="timeago small" >Feb 10, 2024<i class="unloaded">2024-02-10T22:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>One - Kioptrix 1 Writeup</h3><div class="text-muted small"><p> Intro Kioptrix 1 is a boot2root style box, where the main objective is to gain root access on the machine in any way possible. For this machine, we don’t get any flags to flaunt. Enumeration To ...</p></div></div></a></div><div class="card"> <a href="/posts/Two-PCAP-Analysis/"><div class="card-body"> <span class="timeago small" >Feb 27, 2024<i class="unloaded">2024-02-27T22:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Two - LetsDefend - PCAP Analysis Challenge</h3><div class="text-muted small"><p> Intro PCAP Analysis Challenge is a relatively easy challenge where we’re provided with logs from P13’s computer and we’re supposed to answer the questions. PCAP? What is that? PCAP stands for pack...</p></div></div></a></div><div class="card"> <a href="/posts/Three-ImageExfil-PMAT/"><div class="card-body"> <span class="timeago small" >Nov 2, 2024<i class="unloaded">2024-11-02T01:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Three - PMAT Lab - Bonus Binary Malware Analysis</h3><div class="text-muted small"><p> Intro So with my time being completely MIA and being lazy, I just want to mention that I was learning Malware Analysis and I have gained somewhat of a foothold in the same. This blog is just to hig...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Seven-PureHVNC-Dropper/" class="btn btn-outline-primary" prompt="Older"><p>Seven - Malware Analysis - Multi-Stage PureHVNC RAT - Part of PXAStealer</p></a> <a href="/posts/Eight-Blizzard-Windows-Forensics/" class="btn btn-outline-primary" prompt="Newer"><p>Eight - TryHackMe - Blizzard Windows Forensics Challenge</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/Ra16848771">Ra2302</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/privlege-escalation/">privlege escalation</a> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/digital-forensics/">Digital Forensics</a> <a class="post-tag" href="/tags/malware-analysis/">Malware Analysis</a> <a class="post-tag" href="/tags/basics/">basics</a> <a class="post-tag" href="/tags/exploit/">exploit</a> <a class="post-tag" href="/tags/ffuf/">ffuf</a> <a class="post-tag" href="/tags/getcap/">getcap</a> <a class="post-tag" href="/tags/john/">john</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-F1XTFEDQT6"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-F1XTFEDQT6'); }); </script>
